{"id":5652,"date":"2014-11-03T19:05:08","date_gmt":"2014-11-04T03:05:08","guid":{"rendered":"http:\/\/www.opencontrail.org\/?p=5652"},"modified":"2014-11-03T19:05:08","modified_gmt":"2014-11-04T03:05:08","slug":"openstack-neutron-at-scale","status":"publish","type":"post","link":"https:\/\/tungsten.io\/openstack-neutron-at-scale\/","title":{"rendered":"OpenStack Neutron at scale"},"content":{"rendered":"<p>\u201cNeutron cannot scale.\u201d \u2013 This is a pet peeve of several folks, I often meet whether in the customer or vendor or open-source community. I don\u2019t blame them, because their misgivings are not unfounded. In fact, as some of the OpenStack vendors set out to demonstrate the scalability of OpenStack, they had to disable Neutron \u2013 read the recent posts from <a href=\"https:\/\/www.mirantis.com\/blog\/benchmarking-openstack-megascale-tested-mirantis-openstack-softlayer\/\">Mirantis<\/a> and <a href=\"http:\/\/javacruft.wordpress.com\/2014\/06\/18\/168k-instances\/\">Canonical<\/a>.<\/p>\n<p>As I read through the above posts, where they explain one bottleneck after another, I realize how and why the scalability of Neutron is questioned by so many, so frequently. In the Canonical scale tests, the system had so many timeouts and failures, that the \u2018Neutron security group\u2019 feature had to be turned off and eventually Neutron was completely turned off and replaced with \u2018nova networking\u2019. Yes, you read it right ! Because of scale limitations, while the world moved ahead from nova-networks to neutron, these test deployments had to move back. The reason for this limitation is unlike other OpenStack services it difficult to scale out out-of-the-box neutron server. When you enable multiple workers in Neutron there are race conditions to MySQL. Neutron Server and Neutron Agent architecture also poses challenges. Refer to the <a href=\"https:\/\/www.openstack.org\/assets\/presentation-media\/junohpneutronatscalefinal.pdf\">presentation<\/a> from HP specifically talking about the above challenges.<\/p>\n<p>OpenContrail, on the other hand, is a system that has been designed right from day one for scale out. With OpenContrail, a layer 3 overlay is created using a vRouter in the kernel of each of the compute nodes. The policies are defined centrally at the Controller and enforced in a distributed fashion within the vRouter. OpenContrail by default, does all services in distributed fashion &#8211; distributed routing, DHCP, floating IP and DNS &#8211; and that helps it achieve the scale that default Neutron cannot.<\/p>\n<p>When we saw the scalability concerns from the community, we thought of demonstrating OpenContrail capabilities by running a few basic scale tests. Seeing is believing \u2013 so here\u2019s a <a href=\"https:\/\/www.youtube.com\/watch?v=xN0rXHD_dqk\">video<\/a> of the test that we\u2019ve performed.<\/p>\n<p style=\"padding-left: 180px;\">[video_lightbox_youtube video_id=&#8221;xN0rXHD_dqk&#8221; width=&#8221;720&#8243; height=&#8221;540&#8243; auto_thumb=&#8221;1&#8243;]\n<p>\u00a0Some of the salient features of the tests we conducted are:<\/p>\n<ul>\n<li>Contrail cluster scaled up to run 1,000 compute nodes (hence 1,000 vRouters)<\/li>\n<li>The cluster uses just 3 instances of the Controller (Control, Analytics and Config Nodes)<\/li>\n<li>55 Tenants (or Projects)<\/li>\n<li>260 Virtual Networks, together hosting 5,394 virtual machines<\/li>\n<\/ul>\n<p>What we demonstrated is the creation of several security groups to allow traffic between the different virtual networks within a tenant. While traffic ran, some security groups rules were modified and traffic to those virtual networks stopped, without disturbing other ongoing traffic flows, and upon adding those security group rules back, normal traffic resumed.<\/p>\n<p>What you will find particularly interesting in the demo, is that despite the large number of compute nodes, virtual networks and virtual machines at play, the policies defined at the Neutron level is propagated and enforced on all the compute nodes immediately. Secondly and more importantly modification of some of the security group rules, did not bring down all flows (which happens quite often in other implementations). And finally, the network footprint of the OpenContrail components is really small \u2013 and that really highlights the efficiency of the implementation. Below is a quick snapshot of the 1,000 compute nodes in action.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignnone wp-image-5653\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/openstack_neutron_blogpost_image.png\" alt=\"openstack_neutron_blogpost_image\" width=\"800\" height=\"385\" data-id=\"5653\" \/><\/p>\n<p>So, to conclude, \u201cNeutron cannot scale\u201d is just a belief that can be overcome. It just depends on how you implement the Neutron backend. We have tested it with just 1,000 vRouters and we expect this number to scale to several times, without affecting the performance of the system. We will try to demo a further scaled up environment, under higher load conditions in a future demo post. Meanwhile, I would encourage you to take OpenContrail for a scale test-drive and run large numbers of virtual networks and virtual machines, send heavy traffic and see how the system responds. And yes, do report the results back to the community, so others can learn and replicate it.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u201cNeutron cannot scale.\u201d \u2013 This is a pet peeve of several folks, I often meet whether in the customer or vendor or open-source community. I don\u2019t blame them, because their&#8230;<\/p>\n","protected":false},"author":481,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[9,1],"tags":[],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v21.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>OpenStack Neutron at scale - Tungsten Fabric<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/tungsten.io\/openstack-neutron-at-scale\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"OpenStack Neutron at scale - Tungsten Fabric\" \/>\n<meta property=\"og:description\" content=\"\u201cNeutron cannot scale.\u201d \u2013 This is a pet peeve of several folks, I often meet whether in the customer or vendor or open-source community. I don\u2019t blame them, because their...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/tungsten.io\/openstack-neutron-at-scale\/\" \/>\n<meta property=\"og:site_name\" content=\"Tungsten Fabric\" \/>\n<meta property=\"article:published_time\" content=\"2014-11-04T03:05:08+00:00\" \/>\n<meta property=\"og:image\" content=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/openstack_neutron_blogpost_image.png\" \/>\n<meta name=\"author\" content=\"Harshad Nakil\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/tungsten.io\/openstack-neutron-at-scale\/\",\"url\":\"https:\/\/tungsten.io\/openstack-neutron-at-scale\/\",\"name\":\"OpenStack Neutron at scale - Tungsten Fabric\",\"isPartOf\":{\"@id\":\"https:\/\/tungsten.io\/#website\"},\"datePublished\":\"2014-11-04T03:05:08+00:00\",\"dateModified\":\"2014-11-04T03:05:08+00:00\",\"author\":{\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/572395a2824346ce9d2e734c6375ac31\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/tungsten.io\/openstack-neutron-at-scale\/\"]}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/tungsten.io\/#website\",\"url\":\"https:\/\/tungsten.io\/\",\"name\":\"Tungsten Fabric\",\"description\":\"multicloud multistack SDN\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/tungsten.io\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/572395a2824346ce9d2e734c6375ac31\",\"name\":\"Harshad Nakil\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/165b3455e8b47085ae85b19cb2b261c3?s=96&d=mm&r=pg\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/165b3455e8b47085ae85b19cb2b261c3?s=96&d=mm&r=pg\",\"caption\":\"Harshad Nakil\"},\"url\":\"https:\/\/tungsten.io\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"OpenStack Neutron at scale - Tungsten Fabric","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/tungsten.io\/openstack-neutron-at-scale\/","og_locale":"en_US","og_type":"article","og_title":"OpenStack Neutron at scale - Tungsten Fabric","og_description":"\u201cNeutron cannot scale.\u201d \u2013 This is a pet peeve of several folks, I often meet whether in the customer or vendor or open-source community. I don\u2019t blame them, because their...","og_url":"https:\/\/tungsten.io\/openstack-neutron-at-scale\/","og_site_name":"Tungsten Fabric","article_published_time":"2014-11-04T03:05:08+00:00","og_image":[{"url":"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/openstack_neutron_blogpost_image.png"}],"author":"Harshad Nakil","twitter_card":"summary_large_image","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/tungsten.io\/openstack-neutron-at-scale\/","url":"https:\/\/tungsten.io\/openstack-neutron-at-scale\/","name":"OpenStack Neutron at scale - Tungsten Fabric","isPartOf":{"@id":"https:\/\/tungsten.io\/#website"},"datePublished":"2014-11-04T03:05:08+00:00","dateModified":"2014-11-04T03:05:08+00:00","author":{"@id":"https:\/\/tungsten.io\/#\/schema\/person\/572395a2824346ce9d2e734c6375ac31"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/tungsten.io\/openstack-neutron-at-scale\/"]}]},{"@type":"WebSite","@id":"https:\/\/tungsten.io\/#website","url":"https:\/\/tungsten.io\/","name":"Tungsten Fabric","description":"multicloud multistack SDN","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/tungsten.io\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/tungsten.io\/#\/schema\/person\/572395a2824346ce9d2e734c6375ac31","name":"Harshad Nakil","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/tungsten.io\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/165b3455e8b47085ae85b19cb2b261c3?s=96&d=mm&r=pg","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/165b3455e8b47085ae85b19cb2b261c3?s=96&d=mm&r=pg","caption":"Harshad Nakil"},"url":"https:\/\/tungsten.io"}]}},"_links":{"self":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5652"}],"collection":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/users\/481"}],"replies":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/comments?post=5652"}],"version-history":[{"count":0,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5652\/revisions"}],"wp:attachment":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/media?parent=5652"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/categories?post=5652"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/tags?post=5652"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}