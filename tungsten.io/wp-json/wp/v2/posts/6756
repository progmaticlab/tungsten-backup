{"id":6756,"date":"2015-10-24T19:16:18","date_gmt":"2015-10-25T02:16:18","guid":{"rendered":"http:\/\/www.opencontrail.org\/?p=6756"},"modified":"2015-10-24T19:16:18","modified_gmt":"2015-10-25T02:16:18","slug":"contrail-analytics-streaming-api","status":"publish","type":"post","link":"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/","title":{"rendered":"Contrail Analytics Streaming API"},"content":{"rendered":"<p>Contrail Analytics collects information from the various components of the system, and provides the visibility into flows, logs and UVEs that is needed to operate this system. This information is provided via a REST API, which can be used to build management and analytics applications and dashboards. The Contrail UI uses this REST API as well.<\/p>\n<p>In addition to providing HTTP GET APIs <a href=\"http:\/\/www.opencontrail.org\/operational-state-in-the-opencontrail-system-uve-user-visible-entities-through-analytics-api\/\">(Operational State in the OpenContrail system: UVE \u2013 User Visible Entities through Analytics API)<\/a> , we also provide a Streaming API for UVEs and Alerts. This is a very useful option for enabling rapid development of powerful and efficient applications on top of Contrail Analytics. Contrail Analytics Streaming API uses the Server-Sent Events EventSource API , which is standardized as part of HTML5.<\/p>\n<p><a href=\"https:\/\/w3c.github.io\/eventsource\/\">https:\/\/w3c.github.io\/eventsource\/<\/a><\/p>\n<p>See Contrail Analytics Streming API features in a demo:<\/p>\n[video_lightbox_youtube video_id=&#8221;h6GelebZo7A&#8221; width=&#8221;720&#8243; height=&#8221;540&#8243; auto_thumb=&#8221;1&#8243;]\n<h3><\/h3>\n<h3>API details<\/h3>\n<p>Two APIs are provided \u2013 one for alarms (read more about it in the detailed <a href=\"http:\/\/www.opencontrail.org\/contrail-alerts\/\">Contrail Alerts<\/a>\u00a0blogpost), and the other for entire UVE contents:<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\">GET http:\/\/&lt;analytics-ip&gt;:&lt;rest-api-port&gt;\/analytics\/alarm-stream\nGET http:\/\/&lt;analytics-ip&gt;:&lt;rest-api-port&gt;\/analytics\/uve-stream<\/span><\/pre>\n<p>Client may ask for a subset of updates using filters in URL parameters:<br \/>\n\u201ctablefilt=,[\u2026]\u201d will provide updates for only the given UVE table types (e.g. control-node, virtual-machine etc.)<\/p>\n<p>For uve-stream, we can further filter by UVE Content Structures:<br \/>\n\u201ccfilt=,[\u2026]\u201d<\/p>\n<p>Lets take an example.<br \/>\nWe can ask got a stream of all bgp-peer UVE updates as follows:<\/p>\n<p><a href=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image1.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-6757\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image1.png\" alt=\"contrail_analytics_streaming_blogpost_image1\" width=\"1273\" height=\"761\" data-id=\"6757\" \/><\/a><\/p>\n<p>First, we read all existing bgp-peer UVEs and report their contents. Then, we report updates. Continuous updates will be reported as the UVE is updated, until the user closes the connection. The data is reported with \u201ckey\u201d , \u201ctype\u201d, and \u201cvalue\u201d.<\/p>\n<ul>\n<li>The \u201ckey\u201d is the UVE Key.<\/li>\n<li>The \u201ctype\u201d is a UVE Content Structure. Multiple of these may be reported per UVE-Key. When any attribute under a Structure changes, the entire Structure is sent again. When the UVE is deleted, the streaming API will report the \u201ckey\u201d with a \u201ctype\u201d of null.<\/li>\n<li>The \u201cvalue\u201d is a JSON object representing the contents (attributes) of the Structure above. When the Structure is deleted, the streaming API will report the \u201ckey\u201d and Structure \u201ctype\u201d with a value of null.<\/li>\n<\/ul>\n<p>Lets take another example. We have an Analytics Node where the contrail-snmp-collector process has stopped. This will cause an alarm.<br \/>\nThis is what we see in the alarm stream:<\/p>\n<p><a href=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image2.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-6758\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image2.png\" alt=\"contrail_analytics_streaming_blogpost_image2\" width=\"938\" height=\"657\" data-id=\"6758\" \/><\/a><\/p>\n<p>Keep the stream open. Now we repair the system by restarting the contrail-snmp-collector. The stream reports that the alarm has been deleted:<\/p>\n<p><a href=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image3.png\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-6759\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image3.png\" alt=\"contrail_analytics_streaming_blogpost_image3\" width=\"938\" height=\"657\" data-id=\"6759\" \/><\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Contrail Analytics collects information from the various components of the system, and provides the visibility into flows, logs and UVEs that is needed to operate this system. This information is&#8230;<\/p>\n","protected":false},"author":465,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[4,1],"tags":[],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v21.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Contrail Analytics Streaming API - Tungsten Fabric<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Contrail Analytics Streaming API - Tungsten Fabric\" \/>\n<meta property=\"og:description\" content=\"Contrail Analytics collects information from the various components of the system, and provides the visibility into flows, logs and UVEs that is needed to operate this system. This information is...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/\" \/>\n<meta property=\"og:site_name\" content=\"Tungsten Fabric\" \/>\n<meta property=\"article:published_time\" content=\"2015-10-25T02:16:18+00:00\" \/>\n<meta property=\"og:image\" content=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image1.png\" \/>\n<meta name=\"author\" content=\"Anish Mehta\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/\",\"url\":\"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/\",\"name\":\"Contrail Analytics Streaming API - Tungsten Fabric\",\"isPartOf\":{\"@id\":\"https:\/\/tungsten.io\/#website\"},\"datePublished\":\"2015-10-25T02:16:18+00:00\",\"dateModified\":\"2015-10-25T02:16:18+00:00\",\"author\":{\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/444baeeb4500c1d4e511527c6f2da689\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/\"]}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/tungsten.io\/#website\",\"url\":\"https:\/\/tungsten.io\/\",\"name\":\"Tungsten Fabric\",\"description\":\"multicloud multistack SDN\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/tungsten.io\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/444baeeb4500c1d4e511527c6f2da689\",\"name\":\"Anish Mehta\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/b7768e1843852e0ff35acc4c42a5fc3a?s=96&d=mm&r=pg\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/b7768e1843852e0ff35acc4c42a5fc3a?s=96&d=mm&r=pg\",\"caption\":\"Anish Mehta\"},\"url\":\"https:\/\/tungsten.io\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Contrail Analytics Streaming API - Tungsten Fabric","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/","og_locale":"en_US","og_type":"article","og_title":"Contrail Analytics Streaming API - Tungsten Fabric","og_description":"Contrail Analytics collects information from the various components of the system, and provides the visibility into flows, logs and UVEs that is needed to operate this system. This information is...","og_url":"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/","og_site_name":"Tungsten Fabric","article_published_time":"2015-10-25T02:16:18+00:00","og_image":[{"url":"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2015\/10\/contrail_analytics_streaming_blogpost_image1.png"}],"author":"Anish Mehta","twitter_card":"summary_large_image","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/","url":"https:\/\/tungsten.io\/contrail-analytics-streaming-api\/","name":"Contrail Analytics Streaming API - Tungsten Fabric","isPartOf":{"@id":"https:\/\/tungsten.io\/#website"},"datePublished":"2015-10-25T02:16:18+00:00","dateModified":"2015-10-25T02:16:18+00:00","author":{"@id":"https:\/\/tungsten.io\/#\/schema\/person\/444baeeb4500c1d4e511527c6f2da689"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/tungsten.io\/contrail-analytics-streaming-api\/"]}]},{"@type":"WebSite","@id":"https:\/\/tungsten.io\/#website","url":"https:\/\/tungsten.io\/","name":"Tungsten Fabric","description":"multicloud multistack SDN","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/tungsten.io\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/tungsten.io\/#\/schema\/person\/444baeeb4500c1d4e511527c6f2da689","name":"Anish Mehta","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/tungsten.io\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/b7768e1843852e0ff35acc4c42a5fc3a?s=96&d=mm&r=pg","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/b7768e1843852e0ff35acc4c42a5fc3a?s=96&d=mm&r=pg","caption":"Anish Mehta"},"url":"https:\/\/tungsten.io"}]}},"_links":{"self":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/6756"}],"collection":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/users\/465"}],"replies":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/comments?post=6756"}],"version-history":[{"count":0,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/6756\/revisions"}],"wp:attachment":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/media?parent=6756"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/categories?post=6756"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/tags?post=6756"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}