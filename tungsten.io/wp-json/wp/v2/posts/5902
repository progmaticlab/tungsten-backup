{"id":5902,"date":"2014-11-24T13:48:36","date_gmt":"2014-11-24T21:48:36","guid":{"rendered":"http:\/\/www.opencontrail.org\/?p=5902"},"modified":"2014-11-24T13:48:36","modified_gmt":"2014-11-24T21:48:36","slug":"opencontrail-for-nfv-applications","status":"publish","type":"post","link":"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/","title":{"rendered":"OpenContrail for NFV applications"},"content":{"rendered":"<p>The OpenContrail solution uses overlays for network virtualization.<\/p>\n<p>An <a href=\"http:\/\/www.opencontrail.org\/evaluating-opencontrail-virtual-router-performance\">earlier blog<\/a>\u00a0evaluated the performance of the OpenContrail virtual router (vrouter) when run as a kernel module on Linux. As described there, the vrouter module is able to fill a 10G link with TCP traffic from a virtual machine (VM) on one server to a VM on another server without making any assumptions about hardware capabilities in the server NICs. Also, in order to support interoperability and use a standards-based approach, vrouter does not use new protocols\/encapsulations. However, in network function virtualization (NFV) scenarios, other performance metrics such as packets-per-second (pps) and latency are as important as TCP bandwidth. With a kernel module, the pps number is limited by various factors such as the number of VM exits, memory copies and the overhead of processing interrupts. In order to optimize performance for NFV use cases, vrouter has now been integrated with the Intel DPDK (Data Plane Development Kit).<\/p>\n<p>DPDK is a set of libraries and drivers that perform fast packet processing by allowing NICs to DMA packets directly into an application\u2019s address space and having the application poll for packets, thereby avoiding the overhead of interrupts from the NIC. To integrate with DPDK, the vrouter can now run in a user process instead of a kernel module. This process links with the DPDK libraries and communicates with the vrouter host agent, which runs as a separate process. Figure 1 compares the architecture when vrouter runs as a kernel module versus running as a user process. The application inside the guest VM can be written to use the DPDK API or it can use the traditional socket API. However, for NFV applications such as vMX, which require high performance, it would be preferable to use the DPDK API inside the VM.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-5903\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/OC_for_NFV_applications_blogpost_image1.png\" alt=\"OC_for_NFV_applications_blogpost_image1\" width=\"655\" height=\"400\" data-id=\"5903\" \/><\/p>\n<p style=\"text-align: center;\"><strong>Vrouter running as a kernel module<\/strong><\/p>\n<p style=\"text-align: center;\"><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter wp-image-5904\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/OC_for_NFV_applications_blogpost_image2.png\" alt=\"OC_for_NFV_applications_blogpost_image2\" width=\"697\" height=\"400\" data-id=\"5904\" \/><\/p>\n<p style=\"text-align: center;\"><strong>Vrouter running in user space &#8211;<\/strong>\u00a0<strong>Figure 1<\/strong><\/p>\n<p>To evaluate the performance of vrouter running in user space, a setup with 2 servers connected back to back by an Intel 10G interface was used. The servers have 2 CPU sockets each, with 6 cores per socket and 2 threads per core. The processor is an Intel Xeon running at 2.5GHz. The servers have 128GB of memory each and run Ubuntu 12.4.3 as the host operating system. A virtual network is created and a VM is instantiated on each server in this virtual network. Each VM has 4 VCPUs, 8GB of memory and runs Ubuntu 12.04 as the guest operating system. VM1 runs an application (pktgen), which continuously sends 64 byte packets to VM2. VM2 also runs pktgen, which consumes the packet and displays the number of packets thus received. Figure 2 illustrates the setup used to measure performance.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"aligncenter size-full wp-image-5907\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/OC_for_NFV_applications_blogpost_image31.png\" alt=\"OC_for_NFV_applications_blogpost_image3\" width=\"728\" height=\"411\" data-id=\"5907\" \/><\/p>\n<p style=\"text-align: center;\"><strong>Figure 2<\/strong><\/p>\n<p>On this setup, vrouter running in user space is able to forward 4.15 million packets per second from VM1 to VM2. Packets sent by VM1 are encapsulated by vrouter in MPLS-over-UDP before they are sent on the wire. On the receiving server, vrouter decapsulates the packets and sends them to VM2. On the same setup, VMs connected by Linux bridge are able to forward about 500,000 packets per second using the netperf application, so the performance is significantly higher when using vrouter integrated with DPDK. Another benefit of integrating vrouter with DPDK is that a kernel module is not required any more to perform the overlay function. The use of a user-space vrouter is oblivious to other components of the OpenContrail solution, so the control plane, analytics and UI function the same as before. Also, the VMs can communicate with any hardware gateway router (such as the Juniper MX) as before. The only change required is to specify that DPDK based vrouter should be used on the compute servers when a cluster is provisioned. A video of the above performance test can be found below and also on the <a title=\"OpenContrail Videos\" href=\"http:\/\/www.opencontrail.org\/videos\/\">videos<\/a>\u00a0section.<\/p>\n[video_lightbox_youtube video_id=&#8221;ZGiQJrKoDQM&#8221; width=&#8221;720&#8243; height=&#8221;540&#8243; auto_thumb=&#8221;1&#8243;]\n<p>&nbsp;<\/p>\n<p>In summary, the OpenContrail solution achieves significantly better packets-per-second numbers when vrouter is integrated with DPDK, thereby enabling NFV applications with high performance requirements.<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n","protected":false},"excerpt":{"rendered":"<p>The OpenContrail solution uses overlays for network virtualization. An earlier blog\u00a0evaluated the performance of the OpenContrail virtual router (vrouter) when run as a kernel module on Linux. As described there,&#8230;<\/p>\n","protected":false},"author":459,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[12,1],"tags":[],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v21.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>OpenContrail for NFV applications - Tungsten Fabric<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"OpenContrail for NFV applications - Tungsten Fabric\" \/>\n<meta property=\"og:description\" content=\"The OpenContrail solution uses overlays for network virtualization. An earlier blog\u00a0evaluated the performance of the OpenContrail virtual router (vrouter) when run as a kernel module on Linux. As described there,...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/\" \/>\n<meta property=\"og:site_name\" content=\"Tungsten Fabric\" \/>\n<meta property=\"article:published_time\" content=\"2014-11-24T21:48:36+00:00\" \/>\n<meta property=\"og:image\" content=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/OC_for_NFV_applications_blogpost_image1.png\" \/>\n<meta name=\"author\" content=\"Rajagopalan Sivaramakrishnan\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/\",\"url\":\"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/\",\"name\":\"OpenContrail for NFV applications - Tungsten Fabric\",\"isPartOf\":{\"@id\":\"https:\/\/tungsten.io\/#website\"},\"datePublished\":\"2014-11-24T21:48:36+00:00\",\"dateModified\":\"2014-11-24T21:48:36+00:00\",\"author\":{\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/faeed38fb295645b8dbd44f5ab222e0b\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/\"]}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/tungsten.io\/#website\",\"url\":\"https:\/\/tungsten.io\/\",\"name\":\"Tungsten Fabric\",\"description\":\"multicloud multistack SDN\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/tungsten.io\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/faeed38fb295645b8dbd44f5ab222e0b\",\"name\":\"Rajagopalan Sivaramakrishnan\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/045ef86b6fbe80163a14c27589c3c886?s=96&d=mm&r=pg\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/045ef86b6fbe80163a14c27589c3c886?s=96&d=mm&r=pg\",\"caption\":\"Rajagopalan Sivaramakrishnan\"},\"url\":\"https:\/\/tungsten.io\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"OpenContrail for NFV applications - Tungsten Fabric","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/","og_locale":"en_US","og_type":"article","og_title":"OpenContrail for NFV applications - Tungsten Fabric","og_description":"The OpenContrail solution uses overlays for network virtualization. An earlier blog\u00a0evaluated the performance of the OpenContrail virtual router (vrouter) when run as a kernel module on Linux. As described there,...","og_url":"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/","og_site_name":"Tungsten Fabric","article_published_time":"2014-11-24T21:48:36+00:00","og_image":[{"url":"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/OC_for_NFV_applications_blogpost_image1.png"}],"author":"Rajagopalan Sivaramakrishnan","twitter_card":"summary_large_image","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/","url":"https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/","name":"OpenContrail for NFV applications - Tungsten Fabric","isPartOf":{"@id":"https:\/\/tungsten.io\/#website"},"datePublished":"2014-11-24T21:48:36+00:00","dateModified":"2014-11-24T21:48:36+00:00","author":{"@id":"https:\/\/tungsten.io\/#\/schema\/person\/faeed38fb295645b8dbd44f5ab222e0b"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/tungsten.io\/opencontrail-for-nfv-applications\/"]}]},{"@type":"WebSite","@id":"https:\/\/tungsten.io\/#website","url":"https:\/\/tungsten.io\/","name":"Tungsten Fabric","description":"multicloud multistack SDN","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/tungsten.io\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/tungsten.io\/#\/schema\/person\/faeed38fb295645b8dbd44f5ab222e0b","name":"Rajagopalan Sivaramakrishnan","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/tungsten.io\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/045ef86b6fbe80163a14c27589c3c886?s=96&d=mm&r=pg","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/045ef86b6fbe80163a14c27589c3c886?s=96&d=mm&r=pg","caption":"Rajagopalan Sivaramakrishnan"},"url":"https:\/\/tungsten.io"}]}},"_links":{"self":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5902"}],"collection":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/users\/459"}],"replies":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/comments?post=5902"}],"version-history":[{"count":0,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5902\/revisions"}],"wp:attachment":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/media?parent=5902"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/categories?post=5902"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/tags?post=5902"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}