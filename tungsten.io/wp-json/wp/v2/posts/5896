{"id":5896,"date":"2014-11-19T10:36:10","date_gmt":"2014-11-19T18:36:10","guid":{"rendered":"http:\/\/www.opencontrail.org\/?p=5896"},"modified":"2014-11-19T10:36:10","modified_gmt":"2014-11-19T18:36:10","slug":"use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system","status":"publish","type":"post","link":"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/","title":{"rendered":"Use vagrant to bring up a test only single node OpenContrail 1.20 system"},"content":{"rendered":"<p><a href=\"http:\/\/www.opencontrail.org\">OpenContrail<\/a> contains a <a href=\"http:\/\/www.opencontrail.org\/opencontrail-quick-start-guide\/\">quick start guide <\/a>\u00a0with step-by-step instructions to install a single server all in one setup (including Openstack). More often than not, I was in need of a clean OpenContrail node to test a few things against it, only to tear it down again or leave it as a suspended and soon forgotten VM image on the disk.<\/p>\n<p><a href=\"https:\/\/www.vagrantup.com\">https:\/\/www.vagrantup.com<\/a> offers a development environment to create and configure lightweight, reproducible, and portable development environments. Starting from the official Ubuntu Server 14.04 LTS cloud image (<a href=\"https:\/\/vagrantcloud.com\/ubuntu\/boxes\/trusty64\">https:\/\/vagrantcloud.com\/ubuntu\/boxes\/trusty64<\/a>),\u00a0 I created a <a href=\"https:\/\/github.com\/mwiget\/opencontrail\/blob\/master\/Vagrantfile\">Vagrantfile<\/a> for a VirtualBox virtual machine with 8 GBytes of RAM and 2 vcpu\u2019s and a private network (in addition to vagrant\u2019s default NAT network) with a fixed IP address of\u00a0 192.168.33.10. That address can be changed in the Vagrantfile to suit your needs. The provisioning\/install of OpenContrail is controlled via the shell script <a href=\"https:\/\/github.com\/mwiget\/opencontrail\/blob\/master\/provision.sh\">provision.sh<\/a>. That script follows the quick start guide mentioned earlier by first updating Ubuntu to the latest patch release, then downloading and installing OpenContrail 1.20 and OpenStack Icehouse.<\/p>\n<p>The required Vagrantfile and provisioning script can be downloaded from github at <a href=\"https:\/\/github.com\/mwiget\/opencontrail\">https:\/\/github.com\/mwiget\/opencontrail<\/a>:<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\"><code>$ mkdir temp\n$ cd temp\n$ git clone git:\/\/github.com\/mwiget\/opencontrail.git\nCloning into 'opencontrail'...\nremote: Counting objects: 11, done.\nremote: Compressing objects: 100% (11\/11), done.\nremote: Total 11 (delta 2), reused 4 (delta 0)\nReceiving objects: 100% (11\/11), 10.44 KiB | 0 bytes\/s, done.\nResolving deltas: 100% (2\/2), done.\nChecking connectivity... done.\n$\n<\/code><\/span><\/pre>\n<p>The following files should be present in the automatically created directory \u2018opencontrail\u2019:<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\"><code>$ cd opencontrail\n$ ls\nLICENSE\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 README.md\u00a0\u00a0 Vagrantfile provision.sh\n$\n<\/code><\/span><\/pre>\n<p>Ubuntu, OpenContrail and Openstack will be downloaded automatically from the Internet when the virtual machine is launched via \u2018vagrant up\u2019. The initial installation will typically take about 20 minutes and depends on the Internet access speed and the CPU.<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\"><code>\u00a0$ vagrant up\nBringing machine 'default' up with 'virtualbox' provider...\n==&gt; default: Importing base box 'ubuntu\/trusty64'...\n==&gt; default: Matching MAC address for NAT networking...\n==&gt; default: Checking if box 'ubuntu\/trusty64' is up to date...\n==&gt; default: Setting the name of the VM: simple-gateway-vagrant_default_1416160329884_44357\n==&gt; default: Clearing any previously set forwarded ports...\n==&gt; default: Clearing any previously set network interfaces...\n==&gt; default: Preparing network interfaces based on configuration...\ndefault: Adapter 1: nat\ndefault: Adapter 2: hostonly\n==&gt; default: Forwarding ports...\ndefault: 22 =&gt; 2222 (adapter 1)\n==&gt; default: Running 'pre-boot' VM customizations...\n==&gt; default: Booting VM...\n==&gt; default: Waiting for machine to boot. This may take a few minutes...\ndefault: SSH address: 127.0.0.1:2222\ndefault: SSH username: vagrant\ndefault: SSH auth method: private key\ndefault: Warning: Connection timeout. Retrying...\n==&gt; default: Machine booted and ready!\n==&gt; default: Checking for guest additions in VM...\n==&gt; default: Configuring and enabling network interfaces...\n==&gt; default: Mounting shared folders...\ndefault: \/vagrant =&gt; \/Users\/mwiget\/projects\/temp\/opencontrail\n==&gt; default: Running provisioner: shell...\ndefault: Running: \/var\/folders\/8m\/0w01fsfn6j79rb_5x7npp1m40000gn\/T\/vagrant-shell20141116-9617-wys9ae.sh\n==&gt; default: stdin: is not a tty\n==&gt; default: Fix ssh to allow password login\n==&gt; default: ssh stop\/waiting\n==&gt; default: ssh start\/running, process 1701\n==&gt; default: Installing OpenContrail ...\n==&gt; default: apt-get update ...\n==&gt; default: installing curl ...\n==&gt; default: Reading package lists...\n==&gt; default: Building dependency tree...\n. . .\n(bulk of the install messages removed)\n. . .\n==&gt; default: 2014-11-19 09:46:54:628479:\n==&gt; default: 2014-11-19 09:46:54:628595: Done.\n==&gt; default: 2014-11-19 09:46:54:628618: Disconnecting from 192.168.33.10... done.\n==&gt; default: 2014-11-19 09:46:54:701249:\n==&gt; default: You can access horizon web UI http:\/\/192.168.33.10\/horizon\n==&gt; default: You can access OpenContrail web UI http:\/\/192.168.33.10:8080\n==&gt; default: all done.<\/code><\/span><\/pre>\n<p>That\u2019s it! OpenContrail is rebooting and once its back up, is ready for action. The default UI username and password are admin\/secret123 and can be changed in provision.sh. Access the CLI via \u2018vagrant ssh\u2019 and check the status of OpenContrail:<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\"><code>\u00a0$ vagrant ssh\nWelcome to Ubuntu 14.04.1 LTS (GNU\/Linux 3.13.0-39-generic x86_64)\n\u00a0\n* Documentation:\u00a0 https:\/\/help.ubuntu.com\/\n\u00a0\nSystem information as of Wed Nov 19 09:47:09 UTC 2014\n\u00a0\nSystem load: 0.0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Memory usage: 1%\u00a0\u00a0 Processes:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 57\nUsage of \/:\u00a0 6.3% of 39.34GB\u00a0\u00a0 Swap usage:\u00a0\u00a0 0%\u00a0\u00a0 Users logged in: 0\n\u00a0\nGraph this data and manage this system at:\nhttps:\/\/landscape.canonical.com\/\n\u00a0\nGet cloud support with Ubuntu Advantage Cloud Guest:\nhttp:\/\/www.ubuntu.com\/business\/services\/cloud\n\u00a0\n\u00a0\nvagrant@vagrant-ubuntu-trusty-64:~$ contrail-status\n== Contrail vRouter ==\nsupervisor-vrouter:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-vrouter-agent\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-vrouter-nodemgr\u00a0\u00a0\u00a0\u00a0\u00a0 active\n\u00a0\n== Contrail Control ==\nsupervisor-control:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-control\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-control-nodemgr\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-dns\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-named\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0active\n\u00a0\n== Contrail Analytics ==\nsupervisor-analytics:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-analytics-api\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-analytics-nodemgr\u00a0\u00a0\u00a0 active\ncontrail-collector\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-query-engine\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\n\u00a0\n== Contrail Config ==\nsupervisor-config:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-api:0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-config-nodemgr\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-discovery:0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-schema\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-svc-monitor\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\nifmap\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\n\u00a0\n== Contrail Web UI ==\nsupervisor-webui:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-webui\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\ncontrail-webui-middleware\u00a0\u00a0\u00a0\u00a0 active\nredis-webui\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\n\u00a0\n== Contrail Database ==\nsupervisord-contrail-database:active\ncontrail-database\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0active\ncontrail-database-nodemgr\u00a0\u00a0\u00a0\u00a0 active\n\u00a0\n== Contrail Support Services ==\nsupervisor-support-service:\u00a0\u00a0 active\nrabbitmq-server\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 active\n\n<\/code><\/span><\/pre>\n<p>Access the UI at URL <a href=\"http:\/\/192.168.33.10:8080\">http:\/\/192.168.33.10:8080<\/a><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignleft wp-image-5898\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/vagrant_opencontrail_image1.png\" alt=\"vagrant_opencontrail_image1\" width=\"1208\" height=\"800\" data-id=\"5898\" \/><\/p>\n<p>&nbsp;<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" class=\"alignleft wp-image-5898\" src=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/vagrant_opencontrail_image2.png\" alt=\"vagrant_opencontrail_image2\" width=\"1208\" height=\"800\" data-id=\"5898\" \/><\/p>\n<p>&nbsp;<\/p>\n<p>Use vagrant commands to suspend, resume and destroy the virtual machine as needed.<\/p>\n<pre><span style=\"font-family: 'courier new', courier;\"><code>$ vagrant destroy\ndefault: Are you sure you want to destroy the 'default' VM? [y\/N] y\n==&gt; default: Forcing shutdown of VM...\n==&gt; default: Destroying VM and associated drives...\n==&gt; default: Running cleanup tasks for 'shell' provisioner...\n$\u00a0<\/code><\/span><\/pre>\n","protected":false},"excerpt":{"rendered":"<p>OpenContrail contains a quick start guide \u00a0with step-by-step instructions to install a single server all in one setup (including Openstack). More often than not, I was in need of a&#8230;<\/p>\n","protected":false},"author":482,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[11,1],"tags":[],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v21.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric\" \/>\n<meta property=\"og:description\" content=\"OpenContrail contains a quick start guide \u00a0with step-by-step instructions to install a single server all in one setup (including Openstack). More often than not, I was in need of a...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/\" \/>\n<meta property=\"og:site_name\" content=\"Tungsten Fabric\" \/>\n<meta property=\"article:published_time\" content=\"2014-11-19T18:36:10+00:00\" \/>\n<meta property=\"og:image\" content=\"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/vagrant_opencontrail_image1.png\" \/>\n<meta name=\"author\" content=\"Marcel Wiget\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/\",\"url\":\"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/\",\"name\":\"Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric\",\"isPartOf\":{\"@id\":\"https:\/\/tungsten.io\/#website\"},\"datePublished\":\"2014-11-19T18:36:10+00:00\",\"dateModified\":\"2014-11-19T18:36:10+00:00\",\"author\":{\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/70110f1b15faccc9956a9e1a3edfda8d\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/\"]}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/tungsten.io\/#website\",\"url\":\"https:\/\/tungsten.io\/\",\"name\":\"Tungsten Fabric\",\"description\":\"multicloud multistack SDN\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/tungsten.io\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/70110f1b15faccc9956a9e1a3edfda8d\",\"name\":\"Marcel Wiget\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/1b4366bc40f732fd151280f6ecd29f22?s=96&d=mm&r=pg\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/1b4366bc40f732fd151280f6ecd29f22?s=96&d=mm&r=pg\",\"caption\":\"Marcel Wiget\"},\"url\":\"https:\/\/tungsten.io\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/","og_locale":"en_US","og_type":"article","og_title":"Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric","og_description":"OpenContrail contains a quick start guide \u00a0with step-by-step instructions to install a single server all in one setup (including Openstack). More often than not, I was in need of a...","og_url":"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/","og_site_name":"Tungsten Fabric","article_published_time":"2014-11-19T18:36:10+00:00","og_image":[{"url":"http:\/\/www.opencontrail.org\/wp-content\/uploads\/2014\/11\/vagrant_opencontrail_image1.png"}],"author":"Marcel Wiget","twitter_card":"summary_large_image","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/","url":"https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/","name":"Use vagrant to bring up a test only single node OpenContrail 1.20 system - Tungsten Fabric","isPartOf":{"@id":"https:\/\/tungsten.io\/#website"},"datePublished":"2014-11-19T18:36:10+00:00","dateModified":"2014-11-19T18:36:10+00:00","author":{"@id":"https:\/\/tungsten.io\/#\/schema\/person\/70110f1b15faccc9956a9e1a3edfda8d"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/tungsten.io\/use-vagrant-to-bring-up-a-test-only-single-node-opencontrail-1-20-system\/"]}]},{"@type":"WebSite","@id":"https:\/\/tungsten.io\/#website","url":"https:\/\/tungsten.io\/","name":"Tungsten Fabric","description":"multicloud multistack SDN","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/tungsten.io\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/tungsten.io\/#\/schema\/person\/70110f1b15faccc9956a9e1a3edfda8d","name":"Marcel Wiget","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/tungsten.io\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/1b4366bc40f732fd151280f6ecd29f22?s=96&d=mm&r=pg","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/1b4366bc40f732fd151280f6ecd29f22?s=96&d=mm&r=pg","caption":"Marcel Wiget"},"url":"https:\/\/tungsten.io"}]}},"_links":{"self":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5896"}],"collection":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/users\/482"}],"replies":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/comments?post=5896"}],"version-history":[{"count":0,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/5896\/revisions"}],"wp:attachment":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/media?parent=5896"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/categories?post=5896"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/tags?post=5896"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}