{"id":7243,"date":"2016-11-01T10:45:31","date_gmt":"2016-11-01T17:45:31","guid":{"rendered":"http:\/\/www.opencontrail.org\/?p=7243"},"modified":"2016-11-01T10:45:31","modified_gmt":"2016-11-01T17:45:31","slug":"elastic-service-chaining-autoscaling-using-opencontrail","status":"publish","type":"post","link":"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/","title":{"rendered":"Elastic Service Chaining (AutoScaling) using OpenContrail"},"content":{"rendered":"<p><iframe loading=\"lazy\" src=\"https:\/\/www.youtube.com\/embed\/IAoPFW8r4tU\" width=\"600\" height=\"380\" frameborder=\"0\" allowfullscreen=\"allowfullscreen\"><\/iframe><\/p>\n<p><em><strong>Requirements:\u00a0<\/strong><\/em>OpenContrail with OpenStack<\/p>\n<p>What if you have an environment which needs to scale up during periods of peak loads &amp; scale down during normal operations (Eg. Black-Friday). Can you have an automated solution which can handle this kind of scenario to save OpEx\/CapEx?<\/p>\n<p>The answer is YES! OpenContrail as the SDN controller provides a robust solution which will intelligently scale up &amp; scale down the cloud-stack based on user-defined metrics. With this solution, cloud administrators define trigger points &amp; the decision to scale is left to the cloud, thus resulting in an intelligent &amp; elastic cloud.<\/p>\n<p>In the previous <a href=\"http:\/\/www.opencontrail.org\/port-tuples-service-chain-redundancy\/\">blog<\/a>, you have seen how we deploy a service chain using OpenContrail. In this blog, we will see how to enhance the existing service chain to implement the autoscaling feature which will scale up\/down service-instances (Eg. Load-Balancers, Firewalls, etc.) using OpenContrail. An OpenStack project called as <em>\u201cCeilometer<strong>\u201d<\/strong><\/em> is used to generate alarms which will in turn trigger the scale up\/down policies that are defined in the Heat Orchestration Template (HOT).<\/p>\n<p><strong>NOTE:<\/strong> OpenStack Heat is an OpenStack project which is used to orchestrate composite cloud applications using a declarative template format written in YAML through an OpenStack REST API.<\/p>\n<p>OpenStack Ceilometer is an OpenStack project which provides metering, monitoring &amp; alarming features that can be consumed by other OpenStack projects such as Heat.<\/p>\n<p>Below, the video demonstrates how the resources from OpenContrail, Heat &amp; Ceilometer work together to scale up\/down service-instances belonging to a service chain. In theory, the\u00a0process\u00a0works as described below,<\/p>\n<ul>\n<li>Once a service-instance is created, Ceilometer constantly polls the virtual-machine for key performance metrics that are defined in the template. In our case, we specify the metric <em>\u201caverage CPU utilization (avg, cpu_util)\u201d<\/em> of the service-instance cluster. The template also defines thresholds (low &amp; high) to implement the autoscaling feature.<\/li>\n<\/ul>\n<ul>\n<li>Whenever the CPU utilization (load) of the service-instance in the cluster is greater than the upper-threshold value, Ceilometer raises an alarm (<em>Alarm-High<\/em>) &amp; indicates Heat to instantiate &amp; add a new service-instance to the cluster. Therefore, we now have two service-instances in the chain deployed in Active-Active configuration. This reduces the CPU utilization of the first service-instance since the load is now distributed across <strong>TWO<\/strong> service-instances in the cluster. If the average CPU utilization of the cluster is still greater than the upper-threshold value, the autoscaling policy adds another service-instance to the cluster. This autoscaling feature is indicated in the template by the \u201c<em>scaleup_policy\u201d<\/em>.Alternatively, if the average CPU utilization of the entire cluster is less than the lower-threshold value, Ceilometer raises an alarm (<em>Alarm-Low<\/em>) &amp; indicates Heat to remove the newly added instances from the service-instance cluster. This is indicated in the template by the \u201c<em>scaledown_policy\u201d<\/em>.<\/li>\n<\/ul>\n<ul>\n<li>Therefore, we now have an intelligent elastic service-chain that can scale up\/down based on a certain user-defined metric. This provides a higher scalability index along with low OpEx.<\/li>\n<\/ul>\n<ol>\n<li>Some of the key resources &amp; their properties used in the HOT are listed below,OS::ContrailV2::VirtualNetwork \u2013 A resource to create a Virtual Network<br \/>\nOS::ContrailV2::VirtualMachineInterface \u2013 A resource to create a Virtual Machine Interface<br \/>\nOS::ContrailV2::InstanceIp \u2013 A resource to allocate an IP address to an instance<br \/>\nOS::ContrailV2::ServiceTemplate \u2013 A resource to create a Service Template<br \/>\nOS::ContrailV2::ServiceInstance \u2013 A resource to create a Service Instance<br \/>\nOS::ContrailV2::PortTuple \u2013 A resource to create a Service-Instance port tuple<br \/>\nOS::ContrailV2::NetworkPolicy &#8211; A resource to create a Virtual-Network Policy<br \/>\nOS::Heat::AutoScalingGroup \u2013 A resource that allows to create\u00a0a\u00a0desired number of similar resources.<\/p>\n<p>Properties:<\/p>\n<p>1.<strong> Max_size<\/strong>: Maximum number of resources (Service-Instances) in the group<br \/>\n2. <strong>Min_size<\/strong>: Minimum number of resources (Service-Instances) in the group<br \/>\n3. <strong>Desired_capacity<\/strong>: Desired initial number of resources<\/p>\n<p>OS::Heat::ScalingPolicy \u2013 A resource to manage scaling of OS::Heat::AutoScalingGroup<\/p>\n<p>Properties:<\/p>\n<p>1. <strong>Adjustement_type<\/strong>: Type of adjustement (Percentage or Absolute)<br \/>\n2. <strong>Auto_scaling_group_id<\/strong>: Group ID to which the autoscaling policy is applied<br \/>\n3. <strong>Scaling_adjustment<\/strong>: Size of adjustment (+N for scale-up by N, -N for scale-down by N)<\/p>\n<p>OS::Ceilometer::Alarm \u2013 A resource used to raise an alarm<\/p>\n<p>Properties:<\/p>\n<p>1. <strong>Meter_name<\/strong>: The name of the meter. (cpu_util, image, memory)<br \/>\n2. <strong>Statistic<\/strong>: Meter statistic to evaluate (avg, sum, min, max, count)<br \/>\n3. <strong>Period<\/strong>: Period to evaluate over (in seconds)<br \/>\n4. <strong>Evaluation_periods<\/strong>: Number of periods to evaluate over<br \/>\n5. <strong>Threshold:<\/strong> Threshold to evaluate against<br \/>\n6. <strong>Comparison_operator<\/strong>: Operator used to compare specified statistic with threshold (gt, lt, eq)<\/li>\n<\/ol>\n","protected":false},"excerpt":{"rendered":"<p>Requirements:\u00a0OpenContrail with OpenStack What if you have an environment which needs to scale up during periods of peak loads &amp; scale down during normal operations (Eg. Black-Friday). Can you have&#8230;<\/p>\n","protected":false},"author":493,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":{"footnotes":""},"categories":[12],"tags":[],"acf":[],"yoast_head":"<!-- This site is optimized with the Yoast SEO plugin v21.6 - https:\/\/yoast.com\/wordpress\/plugins\/seo\/ -->\n<title>Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric<\/title>\n<meta name=\"robots\" content=\"index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1\" \/>\n<link rel=\"canonical\" href=\"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/\" \/>\n<meta property=\"og:locale\" content=\"en_US\" \/>\n<meta property=\"og:type\" content=\"article\" \/>\n<meta property=\"og:title\" content=\"Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric\" \/>\n<meta property=\"og:description\" content=\"Requirements:\u00a0OpenContrail with OpenStack What if you have an environment which needs to scale up during periods of peak loads &amp; scale down during normal operations (Eg. Black-Friday). Can you have...\" \/>\n<meta property=\"og:url\" content=\"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/\" \/>\n<meta property=\"og:site_name\" content=\"Tungsten Fabric\" \/>\n<meta property=\"article:published_time\" content=\"2016-11-01T17:45:31+00:00\" \/>\n<meta name=\"author\" content=\"Savithru Lokanath\" \/>\n<meta name=\"twitter:card\" content=\"summary_large_image\" \/>\n<script type=\"application\/ld+json\" class=\"yoast-schema-graph\">{\"@context\":\"https:\/\/schema.org\",\"@graph\":[{\"@type\":\"WebPage\",\"@id\":\"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/\",\"url\":\"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/\",\"name\":\"Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric\",\"isPartOf\":{\"@id\":\"https:\/\/tungsten.io\/#website\"},\"datePublished\":\"2016-11-01T17:45:31+00:00\",\"dateModified\":\"2016-11-01T17:45:31+00:00\",\"author\":{\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/fdb3a7c07ca1c0fe0946b51ec25bca5b\"},\"inLanguage\":\"en-US\",\"potentialAction\":[{\"@type\":\"ReadAction\",\"target\":[\"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/\"]}]},{\"@type\":\"WebSite\",\"@id\":\"https:\/\/tungsten.io\/#website\",\"url\":\"https:\/\/tungsten.io\/\",\"name\":\"Tungsten Fabric\",\"description\":\"multicloud multistack SDN\",\"potentialAction\":[{\"@type\":\"SearchAction\",\"target\":{\"@type\":\"EntryPoint\",\"urlTemplate\":\"https:\/\/tungsten.io\/?s={search_term_string}\"},\"query-input\":\"required name=search_term_string\"}],\"inLanguage\":\"en-US\"},{\"@type\":\"Person\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/fdb3a7c07ca1c0fe0946b51ec25bca5b\",\"name\":\"Savithru Lokanath\",\"image\":{\"@type\":\"ImageObject\",\"inLanguage\":\"en-US\",\"@id\":\"https:\/\/tungsten.io\/#\/schema\/person\/image\/\",\"url\":\"https:\/\/secure.gravatar.com\/avatar\/accbd4466fe63e422e122483917b42f2?s=96&d=mm&r=pg\",\"contentUrl\":\"https:\/\/secure.gravatar.com\/avatar\/accbd4466fe63e422e122483917b42f2?s=96&d=mm&r=pg\",\"caption\":\"Savithru Lokanath\"},\"url\":\"https:\/\/tungsten.io\"}]}<\/script>\n<!-- \/ Yoast SEO plugin. -->","yoast_head_json":{"title":"Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric","robots":{"index":"index","follow":"follow","max-snippet":"max-snippet:-1","max-image-preview":"max-image-preview:large","max-video-preview":"max-video-preview:-1"},"canonical":"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/","og_locale":"en_US","og_type":"article","og_title":"Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric","og_description":"Requirements:\u00a0OpenContrail with OpenStack What if you have an environment which needs to scale up during periods of peak loads &amp; scale down during normal operations (Eg. Black-Friday). Can you have...","og_url":"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/","og_site_name":"Tungsten Fabric","article_published_time":"2016-11-01T17:45:31+00:00","author":"Savithru Lokanath","twitter_card":"summary_large_image","schema":{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebPage","@id":"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/","url":"https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/","name":"Elastic Service Chaining (AutoScaling) using OpenContrail - Tungsten Fabric","isPartOf":{"@id":"https:\/\/tungsten.io\/#website"},"datePublished":"2016-11-01T17:45:31+00:00","dateModified":"2016-11-01T17:45:31+00:00","author":{"@id":"https:\/\/tungsten.io\/#\/schema\/person\/fdb3a7c07ca1c0fe0946b51ec25bca5b"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https:\/\/tungsten.io\/elastic-service-chaining-autoscaling-using-opencontrail\/"]}]},{"@type":"WebSite","@id":"https:\/\/tungsten.io\/#website","url":"https:\/\/tungsten.io\/","name":"Tungsten Fabric","description":"multicloud multistack SDN","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https:\/\/tungsten.io\/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https:\/\/tungsten.io\/#\/schema\/person\/fdb3a7c07ca1c0fe0946b51ec25bca5b","name":"Savithru Lokanath","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https:\/\/tungsten.io\/#\/schema\/person\/image\/","url":"https:\/\/secure.gravatar.com\/avatar\/accbd4466fe63e422e122483917b42f2?s=96&d=mm&r=pg","contentUrl":"https:\/\/secure.gravatar.com\/avatar\/accbd4466fe63e422e122483917b42f2?s=96&d=mm&r=pg","caption":"Savithru Lokanath"},"url":"https:\/\/tungsten.io"}]}},"_links":{"self":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/7243"}],"collection":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/users\/493"}],"replies":[{"embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/comments?post=7243"}],"version-history":[{"count":0,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/posts\/7243\/revisions"}],"wp:attachment":[{"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/media?parent=7243"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/categories?post=7243"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/tungsten.io\/wp-json\/wp\/v2\/tags?post=7243"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}